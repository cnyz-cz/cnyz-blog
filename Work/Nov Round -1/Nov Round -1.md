
|  题目名称  | On Still Waters | Namida Ame |   Milk   | November |
| :----: | :-------------: | :--------: | :------: | :------: |
|  题目类型  |       传统        |     传统     |    传统    |    传统    |
|   目录   |      water      |    ame     |   milk   |   nov    |
| 可执行文件名 |      water      |    ame     |   milk   |   nov    |
| 输入文件名  |    water.in     |   ame.in   | milk.in  |  nov.in  |
| 输出文件名  |    water.out    |  ame.out   | milk.out | nov.out  |
|  时间限制  |                 |            |          |          |
|  空间限制  |                 |            |          |          |
| 子任务数目  |        4        |     6      |    7     |          |
注意事项：
- 题目很简单，比某些神秘学校模拟赛简单。
- 题目全是原题，如果你做过原题，请不要声张，闷声发大财。
- 题目大样例不一定强，题目不一定有大样例。
<div style="page-break-after:always"></div>

# On Still Waters
## 题目描述

>Where is paradise? On the way home.
>What if night is dark? We'll be the shooting star.
>What if paths unsure? Courage must endure.
>We are about to reach the shore where hope can soar.
>—— [**On Still Waters**](https://www.bilibili.com/video/BV1d5kAYEEZr/?spm_id_from=333.337.search-card.all.click)

构造一个 $n\times n$ 的 $01$ 矩阵 $a$，满足：
- 每行恰有 $T$ 个 $1$；
- 对任意两行 $i,j$，有且只有一个 $k$，满足 $a_{i,k}=a_{j,k}=1$。
- 若将每一行看成长度为 $n$ 的 $01$ 串，则这些 $01$ 串之间互不相同。

可能无解，有无解的输出请参照输出格式。

## 输入格式
仅一行两个正整数 $n,T$。

## 输出格式
若无解，输出 `No`。
若有解，输出 `Yes`，而后，输出 $n$ 行 $n$ 个整数 $a_{i,j}$，表示你构造的矩阵 $a$。

## 样例
### 样例 1
```
3 2
```
```
Yes
1 1 0
1 0 1
0 1 1
```

### 样例 2
```
3 1
```
```
No
```

## 数据范围
对于全部子任务，均满足 $1\le T\le n\le 500$。

| 子任务编号 |   特殊限制    |  分数  |
| :---: | :-------: | :--: |
|   1   | $n\le 4$  | $20$ |
|   2   | $T\le 3$  | $20$ |
|   3   | $n\le 10$ | $20$ |
|   4   |     无     | $40$ |

<div style="page-break-after:always"></div>
# Namida Ame
## 题目描述

>戸惑いと哀しみに狂う凪をなぞるように
>灯ひとつない夢の中をまた、ひとり、歩く？
>揺らいだ僕の心
>どうやって今、飛べると思う？
>—— [Namid[A]me](https://www.bilibili.com/video/BV1xM4y1k7S3/?spm_id_from=333.337.search-card.all.click)

>不休陀螺：在你的回合，当你没有手牌时，抽一张牌。

总之你正在游玩《Slay the Spire》并获得了不休陀螺，由于一些恶趣味，你的手牌上限被限制在了 $1$。
用 $(a_i,b_i)$ 表示一张牌，其中 $a_i$ 为打出这张牌所需的费用，$b_i$ 为打出这张牌后，可以获得的费用。
现在有 $n$ 张牌组成序列，初始有 $E$ 点费用，你对能不能赢游戏不感兴趣，而是对这一组牌可不可以达成稳定无限感兴趣，具体地：
- 我们称一次打牌为，随机从当前牌堆中抽取一张牌，若费用足够便直接打出，打出的牌进入弃牌堆；
- 经过若干次打牌，牌堆中不再有牌，此时将弃牌堆中的牌移至牌堆。
- 若无论随机打牌的顺序如何，总可以进行无数次打牌，则称这个卡组为稳定无限。

你不仅对当前卡组感兴趣，你还在想，如果取出任意一个区间作为卡组，这个区间稳定无限的情况有多少种？求出稳定无限的区间总数。

## 输入格式
第一行为两个正整数 $n,E$。
接下来一行 $n$ 个正整数 $a_i$。
接下来一行 $n$ 个正整数 $b_i$。

## 输出格式
仅一行一个整数，表示稳定无限的区间总数。

## 样例
### 样例 1
```
2 0
0 0
1 1
```
```
3
```

### 样例 2
```
5 10
9 10 10 0 2
8 5 6 2 5
```
```
4
```

### 样例 3
```
5 10
8 1 6 4 10
7 6 1 8 5
```
```
5
```

### 样例 4
```
10 43
7 9 8 4 2 1 2 13 12 4
4 13 9 6 9 12 13 5 13 10
```
```
51
```

### 样例 5
见附加文件 `ame5.in/ame5.out`，该组数据满足 Subtask 1 的特殊限制。

### 样例 6
见附加文件 `ame6.in/ame6.out`，该组数据满足 Subtask 4 的特殊限制。

### 样例 7
见附加文件 `ame7.in/ame7.out`，该组数据满足 Subtask 5 的特殊限制。

### 样例 8
见附加文件 `ame8.in/ame8.out`。

## 数据范围
对于全部子任务，有 $1\le n\le 10^6$，$0\le E,a_i,b_i\le 10^9$。

| 子任务编号 |        特殊限制         |  分数  |
| :---: | :-----------------: | :--: |
|   1   |     $n\le 5000$     | $20$ |
|   2   |    $b_i\ge a_i$     | $10$ |
|   3   |       $E=10$        | $10$ |
|   4   | $0\le a_i,b_i\le 1$ | $10$ |
|   5   |  $a_i\times b_i=0$  | $20$ |
|   6   |          无          | $30$ |
<div style="page-break-after:always"></div>

# Milk
## 题目描述

>我们在羊水中漫步
>脑海中装满的话 脱口而出净是泡沫
>我看不到 我看不到 分离凝乳指尖
>我听不到 我听不到 沸腾消失不见
>—— [奶水](https://www.bilibili.com/video/BV1px411M7QA)

给定一个长度为 $n$ 的序列 $a_i$。
令 $f(a)$ 如下计算：
- $f(a)$ 初始值为 $0$。
- 选择一个区间 $[l,r]$，满足 $\forall i\in[l,r],a_i=a_l$，并将这个区间删去，使 $f(a)$ 改变为 $10^4\times f(a)+10^2\times l+r$。
- 删去后右侧的序列向左边移动，**编号同时发生变化**。
- 以此类推，直到序列为空。

$f(a)$ 随选择区间的不同会有变化，试问可以产生多少种不同的 $f(a)$？这个数字可能很大，对 $10^9+7$ 取模后输出。

## 输入格式
第一行一个正整数 $n$。
接下来一行 $n$ 个整数 $a_i$。

## 输出格式
仅一行一个整数表示不同 $f(a)$ 的个数。

## 样例
### 样例 1
```
1
1
```
```
1
```

### 样例 2
```
3
3 3 1
```
```
8
```

### 样例 3
```
5
1 2 1 2 1
```
```
165
```

### 样例 4
见附加文件 `milk4.in/milk4.out`，该组数据满足 Subtask 4 的特殊限制。

### 样例 5
见附加文件 `milk5.in/milk5.out`，该组数据满足 Subtask 5 的特殊限制。

### 样例 6
见附加文件 `milk6.in/milk6.out`，该组数据满足 Subtask 6 的特殊限制。

### 样例 7
见附加文件 `milk7.in/milk7.out`。

## 数据范围
对于所有数据，满足 $1\le n\le 50$，$1\le a_i\le n$。

| 子任务编号 |   特殊限制    |  分数  |
| :---: | :-------: | :--: |
|   1   | $n\le 18$ | $8$  |
|   2   |  $a_i=i$  | $4$  |
|   3   |  $a_i=1$  | $4$  |
|   4   |    A,B    | $16$ |
|   5   |     A     | $16$ |
|   6   |     B     | $16$ |
|   7   |     无     | $36$ |
特殊性质 A：不存在 $i<j<k<l$，使得 $a_i=a_k,a_j=a_l,a_i\not=a_j$。
特殊性质 B：不存在 $i<j<k$，使得 $a_i=a_j=a_k$。

<div style="page-break-after:always"></div>

# November
## 题目描述

>浮かべた言葉は 音も無く弾けた
>あたしが恋した 色の無い街並み
>もう一回と思ったのだ 此処にいるわけにいかないから
>寂しくて唄ったのが これが僕と思えたんだ
>—— [November](https://www.bilibili.com/video/BV1Qa411D7bU/?spm_id_from=333.337.search-card.all.click&vd_source=b3daeaea2940dd63e19ba9d7f5916015)

有一棵 $n$ 个点的树，树上每个点有点权 $w_u\in\{1,-1\}$。
定义 $d(u,v)$ 为树上 $u,v$ 两点间的距离。
你将从 $S$ 点出发，携带一个计数器 $p$，其初始值为 $1$，在时刻 $0$ 出发：
- 设你现在在 $u$ 点，当前时刻为 $t$，$p\to p+w_u$。
- 如果 $p=0$，或者 $d(u,1)\le t$，行动结束，记录 $t$ 为答案。
- 移动到 $v$ 点，满足 $(u,v)$ 这条边存在，随后 $t\to t+1$。


你希望获得的答案尽可能大，输出这个最大值。

## 输入格式
第一行两个整数 $n,S$。
接下来一行 $n$ 个整数 $w_i$。
接下来 $n-1$ 行，一行两个整数 $a,b$，代表 $(a,b)$ 为树的一条边。

## 输出格式
仅一行一个整数，代表最大的答案。

## 样例
### 样例 1
```
7 4
-1 -1 -1 1 1 1 -1
2 1
3 2
4 3
5 4
6 5
7 6
```
```
6
```

